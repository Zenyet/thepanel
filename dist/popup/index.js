import{D as d}from"../chunks/types.js";document.addEventListener("DOMContentLoaded",async()=>{const e=await chrome.storage.local.get(["thecircle_config","thecircle_stats"]),n=e.thecircle_config||d,s=e.thecircle_stats||{usageCount:0,aiCalls:0};l(n.shortcut);const c=document.getElementById("usageCount"),r=document.getElementById("aiCalls");c&&(c.textContent=String(s.usageCount)),r&&(r.textContent=String(s.aiCalls));const a=document.getElementById("openMenu");a==null||a.addEventListener("click",async()=>{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(t!=null&&t.id)try{await chrome.tabs.sendMessage(t.id,{type:"TOGGLE_MENU"}),window.close()}catch{try{await chrome.scripting.executeScript({target:{tabId:t.id},files:["content.js"]}),await chrome.scripting.insertCSS({target:{tabId:t.id},files:["assets/content.css"]}),await new Promise(o=>setTimeout(o,100)),await chrome.tabs.sendMessage(t.id,{type:"TOGGLE_MENU"}),window.close()}catch(o){console.error("Failed to inject:",o),alert("无法在此页面使用。可能是浏览器限制的页面。")}}});const i=document.getElementById("openSettings");i==null||i.addEventListener("click",()=>{chrome.runtime.openOptionsPage()})});function l(e){const n=document.getElementById("shortcutHint");if(!n)return;const s=e.split("+");n.innerHTML=s.map(c=>`<span class="px-2.5 py-1 rounded text-sm font-medium bg-white/10 border border-white/20">${c}</span>`).join('<span class="text-sm text-white/50">+</span>')+'<span class="ml-2 text-sm text-white/70">呼出菜单</span>'}
